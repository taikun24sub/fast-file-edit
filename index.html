<!DOCTYPE html>
<html>
<head>
    <title>Fast File Edit</title>
</head>
<body>
    <button id="input-file" type="file" onclick='slc();'>Select File</button>
    <button onclick='read();'>Read</button><button onclick='fwrite();'>Write</button>
    <p>v1.1.0c</p>
    <textarea id='inp' style='width:100vw;height:90vh;'></textarea>
    <script>
        const inp = document.getElementById('inp');
        let handler;
        async function slc(){
            handler = await showOpenFilePicker();
        }
        document.addEventListener('dragover', event => event.preventDefault())
document.addEventListener('drop', async event => {
  event.preventDefault()

  for (let item of event.dataTransfer.items) {
    let _handle = await item.getAsFileSystemHandle()
    if (_handle.kind === 'directory') {
    } else {
      handle = _handle;
        alert('Loaded!');
    }
  }
})
        function read() {
            try {
                const reader = new FileReader();
                reader.onload = () => {
                    inp.value = reader.result;
                };
                reader.readAsText(handler.getFile());
            } catch (e) {
                inp.value = `Error reading file: ${e.message}`;
            }
        }

        async function fwrite() {
            try {
                let writableStream = await handler.createWritable()
                await writableStream.write(inp.value)
                await writableStream.close()
            } catch (e) {
                inp.value = `Error writing file: ${e.message}`;
            }
        }
    </script>
</body>
</html>
